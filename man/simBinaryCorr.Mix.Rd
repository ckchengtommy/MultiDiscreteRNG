% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simBinaryCorr.Mix.R
\name{simBinaryCorr.Mix}
\alias{simBinaryCorr.Mix}
\title{Calculate Intermediate Binary Correlations for Mixed Variables}
\usage{
simBinaryCorr.Mix(
  GPD.theta.vec = NULL,
  GPD.lambda.vec = NULL,
  NB.r.vec = NULL,
  NB.prob.vec = NULL,
  B.n.vec = NULL,
  B.prob.vec = NULL,
  CorrMat,
  no.rows,
  steps = 0.025
)
}
\arguments{
\item{GPD.theta.vec}{Numeric vector of theta parameters for GPD variables (or `NULL` if none).}

\item{GPD.lambda.vec}{Numeric vector of lambda parameters for GPD variables (must match length of `GPD.theta.vec`).}

\item{NB.r.vec}{Numeric vector of dispersion parameters (`r`) for NB variables (or `NULL` if none).}

\item{NB.prob.vec}{Numeric vector of success probabilities for NB variables (must match length of `NB.r.vec`).}

\item{B.n.vec}{Numeric vector of number of trials for Binomial variables (or `NULL` if none).}

\item{B.prob.vec}{Numeric vector of success probabilities for Binomial variables (must match length of `B.n.vec`).}

\item{CorrMat}{Correlation matrix (must be symmetric positive definite with dimensions matching total variables).}

\item{no.rows}{Integer specifying the number of rows (samples) to generate during intermediate binary sampling.}

\item{steps}{Numeric step size (default = 0.025) for correlation adjustment in later iterations.}
}
\value{
A list containing:
  \item{Mixprop}{List of proportions for each variable's binary components.}
  \item{intermat}{Intermediate correlation matrix for binary variables (adjusted to be positive definite if needed).}
  \item{Mlocation}{List of location parameters for each variable.}
  \item{pvec}{Vector of binary probabilities for each variable.}
}
\description{
This function computes intermediate binary correlations to generate a mixture of
Generalized Poisson (GPD), Negative Binomial (NB), and Binomial (B) variables with
a specified target correlation structure. It iteratively adjusts pairwise correlations
in binary space to approximate the desired correlation matrix for the mixed variables.
}
\details{
The function first calculates binary probabilities and properties for each distribution family (GPD, NB, Binomial)
using helper functions `calc.bin.prob.GPD`, `calc.bin.prob.NB`, and `calc.bin.prob.B`. It then iteratively adjusts
pairwise correlations in binary space to match the target correlation structure, using a step size for convergence.
If the intermediate matrix is not positive definite, it is adjusted using `Matrix::nearPD`.
}
\examples{
\dontrun{
# Example with 2 GPD, 1 NB, and 1 Binomial variable
GPD.theta <- c(1, 2)
GPD.lambda <- c(0.5, 0.3)
NB.r <- 10
NB.prob <- 0.2
B.n <- 5
B.prob <- 0.5
CorrMat <- matrix(c(1, 0.3, 0.2, 0.1,
                   0.3, 1, 0.4, 0.2,
                   0.2, 0.4, 1, 0.3,
                   0.1, 0.2, 0.3, 1), 4, 4)
result <- simBinaryCorr.Mix(
  GPD.theta.vec = GPD.theta,
  GPD.lambda.vec = GPD.lambda,
  NB.r.vec = NB.r,
  NB.prob.vec = NB.prob,
  B.n.vec = B.n,
  B.prob.vec = B.prob,
  CorrMat = CorrMat,
  no.rows = 1000
)
}

}
